# 簡単コンパイラ

学習用の簡単なコンパイラです。入力プログラムをコンパイルしてCASL-IIのソースコードを出力します。

## プログラムの説明

プログラムは複数の文からなります。変数、演算子、数字などのトークンの間には空白文字か改行が必要です。

### 代入文

`変数 = 式 ;` の形式です。変数はアルファベットで始まってアルファベット、数字、アンダースコアの連続からなる文字列です。

### ラベル

`ラベル:` の形式です。変数はアルファベットで始まってアルファベット、数字、アンダースコアの連続からなる文字列です。最後にコロンを付けます。

### if文

`if 式 goto ラベル ;` の形式です。式を評価し、0でない場合にはラベルにジャンプします。

### goto文

`goto ラベル :` の形式です。無条件でラベルにジャンプします。

### 関数定義

`ラベル: func 引数 :` の形式です。引数は必ず１個です。

### return文

`return 式 ;` の形式です。必ず値を返します。

### local文

`local 変数 ... ;` の形式です。ローカル変数を宣言します。

### 式

式は、10進整数（16ビット）、変数および演算子による演算が可能です。単項演算子は Not（否定）、二項演算子は、+ (加算)、- （減算）、< （比較）、==（比較）、* （乗算）、/（除算）、% （剰余）のみです。
比較演算子は、条件が成立するときは0以外、成立しないときは0を返します。演算子には優先順位はなく、左結合です。

関数呼び出しは &関数名　引数 ; の形式です。引数は１つのみで、関数名の後の式はすべて引数として解釈されます。

## コンパイラの使い方

```
ruby compile.rb [file]
```

ファイル名を指定すると、そのファイルからプログラムを読んでコンパイルします。ファイル名を省略すると、`a = ( b + 1 ) - 1 ;` というプログラムをコンパイルします。
